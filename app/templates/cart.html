{% extends "base.html" %}

{% block content %}

<br><br>
{% if current_user.is_authenticated %}
<h2>Products in Cart:</h2>
<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product Name</th>
      <th scope="col">Quantity</th>
      <th scope="col">Unit Price</th>
      <th scope="col">Total Price</th>
    </tr>
  </thead>
  <tbody>
    {% for item in cart_items%}
      <tr>
        <th scope="row">{{item.name}}</th>
        <td>{{item.quantity}}</td>
        <td>{{item.price}}</td>
        <td>{{item.quantity * item.price}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
    const totalPriceCells = document.querySelectorAll('td:nth-child(4)');
    let totalPriceSum = 0;
  
    totalPriceCells.forEach((cell) => {
      const totalPrice = parseFloat(cell.textContent);
      totalPriceSum += totalPrice;
    });
  
    const sumContainer = document.createElement('h2');
    sumContainer.innerHTML = `Overall Sum: $${totalPriceSum.toFixed(2)}`;
    document.body.appendChild(sumContainer);
  </script>

{% else %}
<p><a href="{{ url_for('users.login') }}">Log in</a> to see your cart!</p>
{% endif %}

{% endblock %}
